<style>
	.at-expanding-share-button-toggle-bg {
			display: none !important;
	}
	.footer-socials>i {
		font-size: 0px !important;
		font-weight: 200;
	}


	.button-group {
		margin-bottom: 20px;
	}

	.counter {
		display: inline;
		margin-top: 0;
		margin-bottom: 0;
		margin-right: 10px;
	}

	.posts {
		clear: both;
		list-style: none;
		padding-left: 0;
		width: 100%;
		text-align: left;
	}

	.posts li {
		background-color: #fff;
		border: 1.5px solid #d8d8d8;
		border-radius: 10px;
		padding-top: 10px;
		padding-left: 20px;
		padding-right: 20px;
		padding-bottom: 10px;
		margin-bottom: 10px;
		word-wrap: break-word;
		min-height: 42px;
		box-shadow: 8px 8px 5px #888888;
	}

	.btn-primary {
		color: #fff;
		background-color: #337ab7;
		border-color: #2e6da4;
	}
	.at-expanding-share-button-desktop{
		display: none !important;
	}


</style>
<!DOCTYPE html>
<html lang="en">

<head>
	<!-- META -->
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="keywords" content="" />
	<meta name="author" content="" />
	<meta name="robots" content="" />
	<meta name="description" content="" />
	<meta property="og:title" content="" />
	<meta property="og:description" content="" />
	<meta property="og:image" content="" />
	<meta name="format-detection" content="">
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.11.0/mapbox-gl.css" rel="stylesheet">
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.11.0/mapbox-gl.js"></script>

	<!-- FAVICONS ICON -->
	<link rel="icon" href="images/favicon.ico" type="image/x-icon" />
	<link rel="shortcut icon" type="image/x-icon" href="images/favicon.png" />

	<!-- PAGE TITLE HERE -->
	<title>Find Water || YaWater</title>

	<!-- MOBILE SPECIFIC -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

	<!--[if lt IE 9]>
	<script src="js/html5shiv.min.js"></script>
	<script src="js/respond.min.js"></script>
	<![endif]-->

	<!-- STYLESHEETS -->
	<link rel="stylesheet" type="text/css" href="css/plugins.min.css">
	<link rel="stylesheet" type="text/css" href="plugins/fontawesome/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="plugins/themify/themify-icons.css">
	<link rel="stylesheet" type="text/css" href="css/style.min.css">
	<link rel="stylesheet" type="text/css" href="css/templete.min.css">
	<link rel="stylesheet" type="text/css" class="skin" href="css/skin/skin-1.css">
	<link rel="stylesheet" type="text/css" href="css/jquery.localizationTool.css">
	<link href="https://fonts.googleapis.com/css?family=Amatic+SC:400,700&display=swap" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="css/slider.css">

	<!-- Google Font -->
	<style>
		@import url('https://fonts.googleapis.com/css?family=Barlow:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i|Lora:400,400i,700,700i|Montserrat:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i|Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i|Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i&display=swap');
	</style>

	<!-- Papaparse: For reading csv file -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js" integrity="sha512-SGWgwwRA8xZgEoKiex3UubkSkV1zSE1BS6O4pXcaxcNtUlQsOmOmhVnDwIvqGRfEmuz83tIGL13cXMZn6upPyg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

	<style>
		.DZ-theme-btn {
			display: none !important;
		}

		.logo h2 {
			color: black;
			font-size: 35px;
		}

		.top-right ul li {
			list-style: none;
			display: inline-block;
			padding: 0 10px;
		}

		.top-right ul li:hover {
			color: #fff;
		}

		#div-id {
			border: none;
			width: 101%;
			height: 660px;
			position: relative;
			overflow: hidden;
			top: 8em;
		}

		.bb-icon-brand-facebook {
			display: none !important;
		}

		#iframe-id {
			position: absolute;
			top: -5%;
			left: -11px;
			width: 100%;
			height: 100%;
		}

		@media (min-width:667px) {
			#iframe-id {
				top: -16%;
			}
		}

		.clearfix.dez-coming-bx {
			text-align: center;
			padding: 2rem;
		}
		#map { 

			position: relative;
			top: 2%;
			bottom: 0;
			width: 100%;
			height: 80vh;
		 }

		 #dropdowns {
			position: relative;
			top: 5%;
			width:100%;
			height: 50px;
			background-color: 'red';
		 }

		 #legend-container{

			height: 120px;
			width: 220px;
			background-color: 'rgb(255,255,255,0.9)';
			border-radius:8px;
			display: 'flex';
			flex-direction: 'column';
			justify-content: 'space-between';
			align-items: center;
			padding: 8px;
		 }

		 
		 .legend-row {
			display:'flex';
        	height: 30px;
			justify-content: 'center';
			align-items: center;
		 }

		 .legend-text{
			margin-bottom: 0px;
			margin-top:0px;
		 }

		 @supports (-moz-appearance:button) and (contain:paint) {

			#dropdowns {
				margin-top:50px
			}

			}


	</style>

	<script>
		const onSelect = (e)=> {
			console.loe(clicked,e)
		}
	</script>



</head>

<body id="bg" class="font-poppins">

	<!-- <div id="loading-area"><div></div></div> -->
	<div class="page-wraper">
		<canvas class="site-nav-canvas" style="display: none;"></canvas>
		<!-- Content -->
		<!-- Coming Soon Contant -->
		<div class=" header >
			<div class=" header wow fadeIn" data-wow-duration="0.80s" data-wow-delay="0.50s">

			<div class="clearfix dez-coming-bx">
				<div class="center-md" data-wow-duration="1.5s" data-wow-delay="1.0s">
					<div class="logo wow fadeInUp top-left" data-wow-duration="1.5s" data-wow-delay="1.0s">
						<a href="index.html">
							<h2>YaWater</h2>
						</a>
					</div>

					<div class="top-right">
						<ul class="">
							<li class="wow fadeInRight" data-wow-duration="1.5s" data-wow-delay="1.0s"><a
									href="find.html">Find water</a></li>
							<li class="wow fadeInRight" data-wow-duration="1.5s" data-wow-delay="1.0s"><a
									href="About.html">About us</a></li>
							<li class="wow fadeInRight" data-wow-duration="1.5s" data-wow-delay="1.3s"><a
									href="buy.html">Buy Water</a></li>
							<li class="wow fadeInRight" data-wow-duration="1.5s" data-wow-delay="1.6s"><a
									href="legal.html">Legal</a></li>
							<li class="wow fadeInRight" data-wow-duration="1.5s" data-wow-delay="1.9s"><a
									href="Contact.html">Contact us</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div id="dropdowns">

			<select id="select_africa" onchange="onSelectArfica()"> </select>
			<select id="select_asia" onchange="onSelectAsia()"> </select>
			<select id="select_europe" onchange="onSelectEurope()"> </select>
			<select id="select_n_america" onchange="onSelectNAmerica()"> </select>
			<select id="select_s_america" onchange="onSelectSAmerica()"></select>
			<select id="select_australia" onchange="onSelectAustralia()"> </select>

		  
		<div id="map">

	</div>	

	</div>
	<div>
		<!-- <br>
<br>
<br>
		<div class="container">
			<h2 class="text-center">Add Your Comment</h2>
			<div class="nav justify-content-center">
				<div class="col-md-6 col-sm-12 bg-light p-3">
			<form class="">
			  <div class="form-group">
				<textarea class="form-control status-box" rows="3" placeholder="Enter your comment here..."></textarea>
			  </div>
			</form>
			<div class="button-group pull-right">
			  <p class="counter">250</p>
			  <a href="#" class="btn btn-primary">Post</a>
			</div>
			<ul class="posts">
			</ul>
		  </div>
		</div>
		</div> -->
	</div>
	<!-- Content END-->
	</div>
	<!-- JavaScript  files ========================================= -->
	<script src="js/combining.js"></script><!-- Combining JS  -->
	<script src="plugins/countdown/kinetic.js"></script><!-- COUNTDOWN JS -->
	<script src="plugins/countdown/jquery.final-countdown.js"></script><!-- COUNTDOWN JS -->
	<script src="js/jquery.localizationTool.js"></script><!-- localizationTool JS -->
	<script src="js/translator.js"></script><!-- Translator JS -->

	<div class="site-nav-overlay js-nav" z></div>
</body>

</html>

<script>

	var main = function () {
		$('.btn').click(function () {
			var post = $('.status-box').val();
			$('<li>').text(post).prependTo('.posts');
			$('.status-box').val('');
			$('.counter').text('250');
			$('.btn').addClass('disabled');
		});
		$('.status-box').keyup(function () {
			var postLength = $(this).val().length;
			var charactersLeft = 250 - postLength;
			$('.counter').text(charactersLeft);
			if (charactersLeft < 0) {
				$('.btn').addClass('disabled');
			} else if (charactersLeft === 250) {
				$('.btn').addClass('disabled');
			} else {
				$('.btn').removeClass('disabled');
			}
		});
	}
	$('.btn').addClass('disabled');
	$(document).ready(main)
</script>

<script>
	mapboxgl.accessToken = 'pk.eyJ1Ijoib21hcnNsaW13aGl0ZSIsImEiOiJjbGIxOHIxcmYxYXptM3BtOXJsaTQxanoyIn0.6iFG9J7hkcQn3qfIyUe1tw';
	const map = new mapboxgl.Map({
	container: 'map', // container ID
	// Choose from Mapbox's core styles, or make your own style with Mapbox Studio
	style: 'mapbox://styles/mapbox/streets-v11', // style URL
	center: [-96, 37.8],
    zoom: 3,
	
	});

	map.addControl(new mapboxgl.NavigationControl());
	map.addControl(new mapboxgl.FullscreenControl());
    var geojson = {
      'type': 'FeatureCollection',
	  'features':[]
    };
  var mapMode = 'viewAll';

   
  	map.loadImage(
	'./images/png/drop-blue.png',
	(error, image) => {
	if (error) throw error;
	
	// Add the image to the map style.
	map.addImage('water-drop-pub', image);
	})

	map.loadImage(
	'./images/png/drop-purple.png',
	(error, image) => {
	if (error) throw error;
	
	// Add the image to the map style.
	map.addImage('water-drop-priv', image);
	})

	map.loadImage(
	'./images/png/drop-yellow.png',
	(error, image) => {
	if (error) throw error;
	
	// Add the image to the map style.
	map.addImage('water-drop-hot-pub', image);
	})

	map.loadImage(
	'./images/png/drop-red.png',
	(error, image) => {
	if (error) throw error;
	
	// Add the image to the map style.
	map.addImage('water-drop-hot-priv', image);
	})

	function addDataLayer() {
		map.addSource("cat-springs", {
			type: 'geojson',
			data: geojson
		});

	map.addLayer({
				'id': "cat-springs",
				'type': 'symbol', 
				'source': "cat-springs" ,
				'layout': {
					'visibility': 'visible',
					'icon-image': ["match",["get","springtype"],
							["Public Drinking Spring"],"water-drop-pub",
							["Private Drinking Spring"],"water-drop-priv",
							["Free Hot Spring"],"water-drop-hot-pub", 
							["Paid Hot Spring"],"water-drop-hot-priv" 
							,"water-drop-pub"],
							"icon-size": 0.1,
							'icon-allow-overlap' : true,
				},
		}); //add layer
	}

	function drawMap() {
		map.on('load', function() {
					addDataLayer();
					map.on('click', function(e) {
						var features = map.queryRenderedFeatures(e.point, {
						layers: ['cat-springs']
						});
					
						if (!features.length) {
						return;
						}
						var feature = features[0];
					
						var popup = new mapboxgl.Popup({ offset: [0, 10] })
						.setLngLat(feature.geometry.coordinates)
						.setHTML(feature.properties.description)
						.addTo(map);

					});
						// Change the cursor to a pointer when the mouse is over the places layer.
						map.on('mouseenter', 'cat-springs', function() {
						map.getCanvas().style.cursor = 'pointer';
						});
						
						// Change it back to a pointer when it leaves.
						map.on('mouseleave', 'cat-springs', function() {
						map.getCanvas().style.cursor = '';
						});
					// Center the map on the coordinates of any clicked symbol from the 'symbols' layer.
					map.on('click', 'cat-springs', function(e) {
						map.flyTo({ center: e.features[0].geometry.coordinates });
					});
		}); // on load
	
	}
 
	drawMap();

	function addLegendControl() {
		class LegendControl {
			onAdd(map) {
			const div = document.createElement("div");
			div.className = "mapboxgl-ctrl mapboxgl-ctrl-group";
			div.id="legend-container";
			div.innerHTML = `
				<div style="display:flex; ">
					<div style="flex:1;">
						<label class="switch">
							<input type="checkbox" checked id="check-free-cold" onchange="toggleLayer()" />
							<span class="slider"></span>
						</label>
					</div>
					<div style="flex:1;">
						<img src="images/png/drop-blue.png" style="height:18px; width:18px;" alt="drop-icon"/>
					</div>
					<div style="flex:3;">
						<p class="legend-text"><strong>Free Cold Springs</strong></p>
					</div>
				</div>
				<div style="display:flex;">
					<div style="flex:1;">
						<label class="switch">
							<input type="checkbox" checked id="check-paid-cold" onchange="toggleLayer()" />
							<span class="slider"></span>
						</label>
					</div>
					<div style="flex:1;">
						<img src="images/png/drop-purple.png" style="height:18px; width:18px;" alt="drop-icon"/>
					</div>
					<div style="flex:3;">
						<p class="legend-text"><strong>Paid Cold Springs</strong></p>
					</div>
				</div>
				<div style="display:flex;">
					<div style="flex:1;">
						<label class="switch">
							<input type="checkbox" checked id="check-free-hot" onchange="toggleLayer()" /> 
							<span class="slider"></span>
						</label>
					</div>
					<div style="flex:1;">
						<img src="images/png/drop-yellow.png" style="height:18px; width:18px;" alt="drop-icon"/>
					</div>
					<div style="flex:3;">
						<p class="legend-text"><strong>Free Hot Springs</strong></p>
					</div>
				</div>
				<div style="display:flex;">
					<div style="flex:1;">
						<label class="switch">
							<input type="checkbox" checked id="check-paid-hot" onchange="toggleLayer()" />
							<span class="slider"></span>
						</label>
					</div>
					<div style="flex:1;">
						<img src="images/png/drop-red.png" style="height:18px; width:18px;" alt="drop-icon"/>
					</div>
					<div style="flex:3;">
						<p class="legend-text"><strong>Paid Hot Springs</strong></p>
					</div>
				</div>
				`;
			return div;
			}
		}
		const legendControl = new LegendControl();
		map.addControl(legendControl, "bottom-left");
	}
	addLegendControl();
	

	map.on('load', function() {
	fetch("/springs.csv")
	.then(res=>res.text())
	.then(csv=>{
		Papa.parse(csv, {
		complete: function(results) {
			jsonData =   [...(results.data.map((row, index)=>{
				if(index!==0){
					if(
						row[results.data[0].indexOf('lat')]!==null && 
						row[results.data[0].indexOf('lat')]!==0 &&
						row[results.data[0].indexOf('long')]!==null &&
						row[results.data[0].indexOf('long')]!==0 
						){
						return({
							type: "Feature",
							geometry : {
								type:"Point",
								coordinates:[
									parseFloat(row[results.data[0].indexOf('long')]),
									parseFloat(row[results.data[0].indexOf('lat')]),
								]
							},
							properties:{
								springtype: row[results.data[0].indexOf('spring_type')],
								url: row[results.data[0].indexOf('gmaps')],
								title: row[results.data[0].indexOf('name')],
								continent: row[results.data[0].indexOf('continent')],
								country: row[results.data[0].indexOf('country')],
								icon : "water",
								description: `<div class="marker">
									<h5>${row[results.data[0].indexOf('name')]}</h5>
									<a href="${row[results.data[0].indexOf('gmaps')]}" target="_blank" rel="noopener noreferrer" >Go to location</a>
									</div>`
							}
						})
					}
					
				}
			}))]

			geojson['features'] = jsonData.filter(f=>f!==undefined);

			console.log('jsonData',jsonData);
			

			map.getSource('cat-springs').setData({
				type :"FeatureCollection",
				features: jsonData.filter(d=>d!=null)
			});
		}
	});
	});

	if ( mapMode != 'viewAll' ) {
		// Viewing a category page
		var cat = '';
		
		var filteredFeatures = map.getSource('cat-springs')._options.data.features.filter((feature) => {
			return (feature.properties.category.indexOf(cat) >= 0);
		});
		
			if ( filteredFeatures.length <= 0 ) {
			return false;
			}
			
			var newBounds = new mapboxgl.LngLatBounds();
		
			filteredFeatures.forEach(function(feature) {
				newBounds.extend(feature.geometry.coordinates);
			});
		
			map.fitBounds(newBounds, {
			padding: 20
			}); 
		} 
    }); // on load

	/** Add Data in options */
	const africa_states = ['Africa','South Africa'];
	const asia_states = ['Asia','China','India','Indonesia','Iraq','Israel','Japan','Malaysia','Nepal','Pakistan','Philippines','Russian Federation','Saudi Arabia','South Korea','Taiwan','Turkey','Vietnam']
	const europe_states = ['Europe','Austria','Azerbaijan','Belgium','Bosnia abd Herzegovina','Bulgaria','Croatia','Czech Republic','Denmark','England','Estonia','Finland','France','Georgia','Germany','Greece','Iceland','Irelance','Italy','Lithuania','Macedonia','Moldova','Montenegro','Netherlands','North Wales','Norway','Poland','Romania','Scotland','Slovakia','Slovenia','Spain','Sweden','Switzerland','Turkey','Ukraine','Wales']
	const n_america_states = ['North America','Canada','Caribbean Islands','Central America','Mexico','United States']
	const s_america_states = ['South America','Brazil','Chile','Ecuador','Peru','Venezuela']
	const australia_states = ['Australia','New Zealand']

	

	const selectAfrica = document.getElementById('select_africa');
	africa_states.forEach(a=>selectAfrica.add(new Option(a,a)));

	const selectAsia = document.getElementById('select_asia');
	asia_states.forEach(a=>selectAsia.add(new Option(a,a)));

	const selectEurope = document.getElementById('select_europe');
	europe_states.forEach(a=>selectEurope.add(new Option(a,a)));

	const selectNAmerica = document.getElementById('select_n_america');
	n_america_states.forEach(a=>selectNAmerica.add(new Option(a,a)));

	const selectSAmerica = document.getElementById('select_s_america');
	s_america_states.forEach(a=>selectSAmerica.add(new Option(a,a)));

	const selectAustralia = document.getElementById('select_australia');
	australia_states.forEach(a=>selectAustralia.add(new Option(a,a)));


	/**  On Drop down select */
	function onSelectAfrica() {
		var x = document.getElementById("select_africa").value;
		console.log('you selected ',x);
		zoomMapToBounds(x);
	}

	function onSelectAsia() {
		var x = document.getElementById("select_asia").value;
		console.log('you selected ',x);
		zoomMapToBounds(x);
	}

	function onSelectEurope() {
		var x = document.getElementById("select_europe").value;
		console.log('you selected ',x);
		zoomMapToBounds(x);
	}

	function onSelectNAmerica() {
		var x = document.getElementById("select_n_america").value;
		console.log('you selected ',x);
		zoomMapToBounds(x);
	}

	function onSelectSAmerica() {
		var x = document.getElementById("select_s_america").value;
		console.log('you selected ',x);
		zoomMapToBounds(x);
	}

	function onSelectAustralia() {
		var x = document.getElementById("select_australia").value;
		console.log('you selected ',x);
		zoomMapToBounds(x);
	}


	function zoomMapToBounds(c){
		const bounds = new mapboxgl.LngLatBounds();
        geojson['features']
        .filter(f=>
            (f.properties.continent && f.properties.continent.toLowerCase().includes(c.toLowerCase())) || 
            (f.properties.country && f.properties.country.toLowerCase().includes(c.toLowerCase())))
        .forEach(f=>{
            bounds.extend(f.geometry.coordinates);
        })
        map.fitBounds(bounds, {
            padding: 20
        });
	}


	/** Toggle Functions for legend*/

	function toggleLayer(){
		var chkFreeCold=document.getElementById("check-free-cold").checked;
		var chkPaidCold=document.getElementById("check-paid-cold").checked;
		var chkFreeHot=document.getElementById("check-free-hot").checked;
		var chkPaidHot=document.getElementById("check-paid-hot").checked;

		let activeLayers = [
			...(chkFreeCold?['Public Drinking Spring']:[]),
			...(chkPaidCold?['Private Drinking Spring']:[]),
			...(chkFreeHot?['Free Hot Spring']:[]),
			...(chkPaidHot?['Paid Hot Spring']:[]),
		]


		console.log(activeLayers);
		map.getSource('cat-springs').setData({
				type :"FeatureCollection",
				features: geojson.features
				.filter(d=>d!=null)
				.filter(f=>activeLayers.includes(f.properties.springtype))
		});
	}

</script>